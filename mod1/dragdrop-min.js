var browserPos=null;function setFormValueOpenBrowser(a,c,b){var a=a+"&mode="+c+"&bparams="+b;browserWin=window.open(a,"templavoilareferencebrowser","height=350,width="+(c=="db"?650:600)+",status=0,menubar=0,resizable=1,scrollbars=1");browserWin.focus()}function setFormValueFromBrowseWin(f,e,c,a){if(e){var b=e.split("_");var d=b.pop();b=b.join("_");browserPos.href=browserPos.rel.replace("%23%23%23",b+":"+d);jumpToUrl(browserPos.href)}}function jumpToUrl(a){window.location.href=a;return false}function setHighlight(a){top.fsMod.recentIds.web=a;top.fsMod.navFrameHighlightedID.web="pages"+a+"_"+top.fsMod.currentBank;if(top.content&&top.content.nav_frame&&top.content.nav_frame.refresh_nav){top.content.nav_frame.refresh_nav()}}function editRecords(c,b,d,a){window.location.href=T3_TV_MOD1_BACKPATH+"alt_doc.php?returnUrl="+T3_TV_MOD1_RETURNURL+"&edit["+c+"]["+b+"]=edit"+d}function editList(b,a){var c="";var d=0;var e=a.indexOf(",");while(e!=-1){if(cbValue(b+"|"+a.substr(d,e-d))){c+=a.substr(d,e-d)+","}d=e+1;e=a.indexOf(",",d)}if(cbValue(b+"|"+a.substr(d))){c+=a.substr(d)+","}return c?c:a}var sortable_currentItem;function sortable_unhideRecord(a,b){jumpToUrl(b)}function sortable_hideRecord(a,b){if(!sortable_removeHidden){return jumpToUrl(b)}while((typeof a.className=="undefined")||(a.className.search(/tpm-element(?!-)/)==-1)){a=a.parentNode}new Ajax.Request(b);new Effect.Fade(a,{duration:0.5,afterFinish:sortable_hideRecordCallBack})}function sortable_hideRecordCallBack(b){var a=b.element;while(a.lastChild){a.removeChild(a.lastChild)}}function sortable_unlinkRecordCallBack(a){$parentSortable=TYPO3.jQuery(a).parents(".ui-sortable");a.remove();sortable_updateItemButtons($parentSortable[0],$parentSortable.sortable("toArray"))}function sortable_unlinkRecord(a,c,b){new TYPO3.jQuery.ajax({url:TYPO3.settings.ajaxUrls["Extension\\Templavoila\\Module\\Mod1\\Ajax::unlinkRecord"],type:"post",cache:false,data:{unlink:a}}).done(function(d){new TYPO3.jQuery("#"+c).fadeTo("fast",0,function(){sortable_unlinkRecordCallBack(TYPO3.jQuery(this))})})}function sortable_unlinkRecordSidebarCallBack(d){var c=$("tx_templavoila_mod1_sidebar-bar").childElements();var b=0;for(var a=0;a<c.length;a++){b+=c[a].getHeight()}$("tx_templavoila_mod1_sidebar-bar").morph({height:b+"px"},{duration:0.1,afterFinish:function(){$("tx_templavoila_mod1_sidebar-bar").setStyle({height:"auto"});if(d&&$(d)){$(d).highlight()}}})}function sortable_updateItemButtons(b,a){a.forEach(function(e,c){var d=sortable_containers["#"+b.id]+(c+1);TYPO3.jQuery("#"+e).find("a").each(function(){$this=TYPO3.jQuery(this);if($this.hasClass("tpm-new")){this.setAttribute("onclick",this.getAttribute("onclick").replace(/&parentRecord=[^&]+/,"&parentRecord="+d))}if($this.hasClass("tpm-browse")){if(this.rel){this.rel=this.rel.replace(/&destination=[^&]+/,"&destination="+d)}}if($this.hasClass("tpm-delete")){this.href=this.href.replace(/&deleteRecord=[^&]+/,"&deleteRecord="+d)}if($this.hasClass("tpm-unlink")){this.href=this.href.replace(/unlinkRecord\('[^']+'/,"unlinkRecord('"+d+"'")}if($this.hasClass("tpm-cut")||$this.hasClass("tpm-copy")||$this.hasClass("tpm-ref")){this.href=this.href.replace(/CB\[el\]\[([^\]]+)\]=[^&]+/,"CB[el][$1]="+d)}if($this.hasClass("tpm-pasteAfter")||$this.hasClass("tpm-pasteSubRef")){this.href=this.href.replace(/&destination=[^&]+/,"&destination="+d)}if($this.hasClass("tpm-makeLocal")){this.href=this.href.replace(/&makeLocalRecord=[^&]+/,"&makeLocalRecord="+d)}})})}function sortable_update(d,b,c){destinationIndex=c.indexOf(b.id);if(destinationIndex!=-1&&sortableSource!=null){var a=sortable_containers["#"+d.id]+destinationIndex;new TYPO3.jQuery.ajax({url:TYPO3.settings.ajaxUrls["Extension\\Templavoila\\Module\\Mod1\\Ajax::moveRecord"],type:"post",cache:false,data:{source:sortableSource,destination:a}}).done(function(e){})}sortable_updateItemButtons(d,c)}function sortable_start(c,a,b){sortableSource=sortable_containers["#"+c.id]+(b.indexOf(a.id)+1);sortableSourceList="#"+c.id}function sortable_stop(){sortableSource=null;sortableSourceList=null}function tv_createSortable(b,c){var a=TYPO3.jQuery(b);a.sortable({connectWith:c,handle:".sortable_handle",items:".sortableItem",tolerance:"pointer",opacity:0.5,revert:true,start:function(d,e){sortable_start(TYPO3.jQuery(this)[0],e.item[0],TYPO3.jQuery(this).sortable("toArray"))},update:function(d,e){sortable_update(TYPO3.jQuery(this)[0],e.item[0],TYPO3.jQuery(this).sortable("toArray"))},stop:function(d,e){sortable_stop()},forcePlaceholderSize:true,placeholder:"drag-placeholder"});a.disableSelection()};